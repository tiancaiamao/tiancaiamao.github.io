<html lang="zh_CN"><head><meta charset="utf-8" /><title>在 PingCAP 的一些技术挑战</title><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" /></head><body><div class="navbar navbar-inverse"><div class="container"><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href="/">Home</a></li><li><a href="/index">Blog</a></li><li><a href="/project">Project</a></li><li><a href="/about">About</a></li><li><a href="/feed.atom">Rss</a></li></ul></div></div></div><div class="container"><div class="row row-offcanvas row-offcanvas-right"><div class="col-sm-9"><div id="content"><h1 id="Title">在 PingCAP 的一些技术挑战</h1><p>2018-06-02</p><h2>事务优化</h2><p>ACID 事务支持是 TiDB 的基础，也是核心竞争力。做 AP 强调性能，即使不保证强一致性至少还能用。TP 里面，做核心的交易业务，不保证事务谁敢用？涉及钱的事情，事务没做好谁敢用？虽说是 TiDB 号称是 HTAP 的数据库，如果打分，事务这块必须是 1，其它的亮点做的好是在后面加 0。如果 1 没做好，那就 0 分了。</p><p>TiDB 的事务模型是基于 Percolator 做的。模型方面能不能优化，去掉中心化时钟？ 这个模型会需要从 pd 取一个全局的时间戳，这需要走一次网络交互，会增加事务延迟。设计之初我们假定，同机房内部网络来回一次就 0.5ms，拿一次 timestamp 几乎全落在 1ms 以内。但是后来发现，还是有很多场景这个迟延是很难严格保证的。比如之前我写过受到机器负载的影响，Go 在 runtime 的调度耗时，再比如，跨机房了，网络天然慢了怎么办？那么，能否在事务模型上修改，不去取 timestamp 呢？</p><p>锁冲突的处理策略能否优化呢？ 现在 TiDB 的冲突处理其实是乐观锁策略，大家都会往 TiKV 存储里面写数据，直到发现冲突了，会自己 abort 掉。实际上，这种 abort 的代价是非常高的，在冲突严重的场景十分低效，相当于冲突时做了很多事情，后面这些事情不仅白做了，而且还要额外的撤销操作：写了一半的数据和锁需要清理掉。那么，我们可不可以做一个排队机制呢？ 让可能冲突的事务都去排队，减少乐观锁的冲突开销。在分布式的场景下，如何识别所有节点在哪些 key 上面冲突呢？</p><p>大小事务优先级怎么做。我们假设事务有些很大，有些比较小。是不是会发生，越大的事务越可能出现冲突概率越高？这种情况下，大的事务会不会多次的失败重试，失败重试？另外，会不会大的事务锁住大量的 key，导致小的事务受影响。到底怎么样做才是更公平的呢，是否应该设置合理的大小事务的优先级策略？</p><p>隔离级别怎么做？当前 TiDB 的默认的事务隔离级别是 SI，如果想做 SSI 需要使用 select for update 语句。有没有别的方式实现？默认想做成 SSI 该如何实现，会引入哪些性能影响？还有，假设是 RC 又可以实现什么优化？ 还有一些更细分的隔离级别是否需要加入考虑？ 这些都是值得探讨的。</p><p>事务为什么需要两阶段提交，一阶段提交行不行？我们是否可以优化数据的分布，将事务所涉及的资源，全部都调度到一个物理的机器上面，然后执行一阶段提交呢。`整个事务实现的执行链很长，性能上还有哪些优化能做？举个例子，我曾经发现一个普通的 SQL 语句， update 带索引的列，竟然花掉了近 20ms。首先它是既需要更新索引又需要更新数据的。然后，一个普通的 update 语言，它可能需要先读后写。读需要先向 pd 拿 timestamp，走一次网络，然后向 TiKV 的 raft leader读，走一次网络。再做写的时候，做两阶段提交要走两次网络。而 raft 那边请求又还涉及，多节点的消息同步网络和写磁盘开销。突然想到，一条SQL语句，从发送给数据库到返回给客户端，整个执行流程的所有细节，是一个很好面试题。</p><p>再比如多版本数据的 GC 策略。数据 GC 是事务必须考虑的。在 MVCC 之上，不停的写入，同个条记录就会有许多版本。这些旧版本是需要清理掉的。同时，还有残留的锁也是要清理的。之前就出现过很多问题。像数据版本太多，会导致读的速度变慢，因为 rocksdb 那边要顺着 MVCC 不同版本的数据扫，直接找到需要的那个。如果版本多了，扫的 key 就变多，性能就下降。删除数据是很影响性能的，极端的场景，不停地做插入和删除，GC 的速度跟不上怎么办？ 清锁的细节如何处理，异步清锁的操作。并发 GC 是否安全？ 遇到大事务要读老的数据，GC 应该如何处理，如果清理，读的事务执行就要出错。不清理，如果一直有大事务会把 GC 卡住怎么办？</p><p>细节很多很多，反正都是做事务优化的人必须考虑到的。更重要的事情，是事务出了 bug 怎么办。上层业务写错了，该重试没重试，或者不该重试却重试了，把错误的数据写进去，或者数据索引不一致了。又或者，下层存储把数据写丢了，却告诉调用者成功了。做事务需要非常强大和全面的分析能力，抗压能力。因为几乎所有的问题，都可以引发事务的问题，这边做事务相关，又称背锅侠。</p><h2>如何做资源隔离</h2><p>这也是比较大的一个话题。TiDB 号称是一个 HTAP 混合的数据库。混合嘛，即做 AP 又做 TP，那么就有用户问了，同时在 TP 的集群上面，直接跑 AP 做数据分析，会不会影响 TP 的响应呢？ 那我只能如实回答，当然会呀！ TiDB 是有一定的分析能力，但是目前阶段还没有一些纯粹 AP 的引擎强大。另外，AP 会吃掉机器大量的资源，同时在执行的线上业务肯定要受到影响。</p><p>所以问题来了，怎么样调度，使得 AP 和 TP 互不影响呢？或者至少影响尽量地小。TiDB 是无状态的，可以把节点实例独立出来，AP 和 TP 分开。在 TiKV 那边，就没法在物理层面划分了。我们能不能给不同的事务类型，加上不同的优先级和资源分配策略。SQL 一个特别复杂的东西，一条 SQL 语句与另一条 SQL 语句之间，需要的计算资源几乎不可同日而语。到底需要占用多少资源，这个有没有办法量化？它会读多少条数据，写多少磁盘，吃多少 CPU 和 IO，内存占用是怎么样的，这个能否预测和计算？ 如果能够预测出来，这是一个消耗资源的请求，那么能不能根据当前系统负载去做一些处理，比如限制它使用的资源量，内存不够先 dump 出去。</p><p>数据库上云是一个战略方向，好，问题来了，多租户该怎么做。我们能不能做到用户无感知，能不能只部署一套了，按 namespace 卖？ 这就需要最好是懂容器，k8s 的人交流探讨。</p><h2>JIT 怎么做</h2><p>如何让生成的查询执行得更快呢？ 查询优化是一个很大的领域，虽然 TiDB 已经做了不少工作了，但是还有更多的事情其实是空白的。就比如 JIT，直接将查询计划，生成到原生代码，这是很多数据库都已经实现了的。</p><p>我们要解决一个，如何让 Go 和 Rust 共用一份 JIT 的代码。Go 带 runtime 的语言，中间如何调用 C 或者其它语言的库。</p><p>涉及到的重构也会有点多，volcano 模型需要在代码层面做哪些调整，推和拉的不同模式会如何影响到执行效率，做向量化在 TP 里面的收益如何。</p><p>这中间的路线该如何走，需不需要使用 LLVM 呢。这都是很有意思并且具有挑战的事情。这里面自然也涉及了不少汇编和编译器方面的东西，所以，做编译器的人，也是可以转数据库的。</p><h2>分析定位问题的能力</h2><p>不是开玩笑，这真的是很有挑战的事情，而且对综合素质要求相当高，如果展开来说，是一个很大的话题。</p><p>监控，性能，日志，这都是很重要的环节，千万不能小瞧的环节。</p><p>怎么样做监控，怎么样分析性能，怎么样去发现问题的手段。很多情况下，程序的日志是拿不到的，那能够依赖的就只有监控了。除了直观的系统本身的监控，还有一些额外的信息，比如关于机器情况。网络，系统调用，锁，上下文切换，TCP的协议栈，内核调参各种问题。perf，火焰图，Go 语言本身的相关工具等等。程序崩溃了，需要收集哪些信息。dmsg 怎么看，OOM 问题如何查，gdb 去调 core 文件等等。</p><p>每次出错，其实都要去反思和总结，查问题的时候根据什么线索，做了什么推理，最后是用什么方式查到问题的。如果走了弯路，下一次如何避免这种弯路。这个过程中，哪些地方卡住过，缺了什么工具？ 监控，日志，有哪些是该记录没有记录的。整个过程到最后要去复盘，去文档化，养成一种思维的习惯。</p><p>在这里，我们遇到过 <a href="https://pingcap.com/blog/2017-09-08-rocksdbbug/">rocksdb 的问题</a>，我们遇到过 grpc 的问题，所有三方库，都不可能是绝对稳定的，甚至操作系统和编译器，都有可能遇到问题。生产部署时，只推荐特定的环境，为什么？是因为我们验证过。像某些特定文件系统的 bug 导致的问题我们也被坑过。</p><p>有些很难查的 bug，处理这种问题的能力非常重要。比如只有 error 日志 &quot;fatal: morestack on g0&quot;，进程 hang 住，也不退出，也不打印栈，但是所有的 goroutine 都 block 住了。这是一个线上遇到的问题，但是概率特别低，如何抓到它？遇到这少量的线索时怎么处理呢，第一时间要检测到这种情况的发生，监控 log，进程不退出就需要 kill 掉并优先恢复服务。接着是不是应该分析最近改动了啥，如果怀疑编译器的问题，放不同版本编译出来的二进制做对比测试。如果不容易复现，可否考虑抓到线上的流量，放到模拟的环境里面回放？ 最终这个定位是在某个版本 Go 编译器自身的<a href="https://github.com/golang/go/issues/23360">问题</a>。处理 panic 的 recovery 的时候，继续在里面做分配，调度器所在的 g0 崩溃了，然而没有让整个进程退出，无法调度了，于是 hang 住。</p><p>再举一个例子，系统慢了，如何定位为什么慢？ 是整体慢还是部分的语句执行慢，是系统负载过高，还是某一项问题，比如 IO，或者写盘。如果是一条 SQL 语句慢，是语句本身复杂还是有热点，或者是代码优化的有问题。生成的查询计划是怎么样的，执行过程中有没有受到什么干扰。还有，如何从海量的信息里面迅速定位出来有用的那些。我们是不是可以做个 tracing 工具，将整个系统的每个步骤执行耗时记录下来，便于定位问题。关键的点是在于，工具和方法论，这是解决问题的手段。</p><p>另外，到高手阶段，大多都是 printf 的。如果还过于依赖单步调试... 那就呵呵哒。开个玩笑，这边有个同事，我们戏称亚洲第一 rust 程序员，让他review一遍代码，就是开启O4编译（一脸认真）。在大脑里面建模，把代码拆成一小块一小块的，然后人脑跑一遍，训练强大的分析能力，这才是正确的方向。</p><p>分析定位问题在这边是很有挑战的，真的。这个系统足够复杂。出问题时，涉及到的东西足够底层。</p><h2>分布式的执行器</h2><p>让 TiKV 完全负载存储，让 TiDB 完全负责 SQL 层的计算，逻辑上没什么毛病，这也是最开始的做法。然而真的把数据从 TiKV 进程全捞上来，到在 TiDB 进程里面做计算，这个数据走网络开销是很大的，并且计算的过程无法过滤掉不必要的数据。</p><p>移动数据不如移动计算，所以我们做了 coprocessor，做下推，把一部分计算下推到 TiKV 节点上面去做。TiKV 是分布式的，于是计算量就分摊到整个集群节点上面了。逻辑上，coprocessor 还是属于 TiDB 层面的，而物理上，它又在 TiKV 里面实现。下推以后，TiKV 那边计算与存储耦合得有点多了，倒不是指概念的耦合，而是资源分配。下推的计算量会影响到存储，grpc 网络也是一个很吃 CPU 的部分。</p><p>可是下推只是解决了一部分的问题。我们需要的，是一个真正的分布式的执行器层。</p><p>下推之后，还需要在上层做一些聚合的计算，现在操作还只能够在单个 TiDB 节点上面完成。单节点上面资源有限，比如说容易把内存打爆，或者如果有多节点，资源还可以达到更好的利用。面对实际要解决的问题：一个大的 Join 查询，把机器内存打暴了怎么办？ Go 语言是一个带 GC 的语言。这 GC 语言里面做内存控制，也是一个相对麻烦事情。</p><p>分布式执行器，需要把纯粹 SQL 生成的执行计划，跟计划的执行（哦，有点绕）拆开来。这个执行计划应该是分布式的，可以被拆到其它节点上去并行执行，最后将结果汇总并返回，把多核或者说多线程的思维，进一步分散到多机器去做。但是这个引入的复杂度就不是一点了，因为跨了机器，机器挂了怎么办，木桶效最慢的一环影响整体速度怎么处理，哪些是能拆的，哪些不能拆，以及怎么拆，细节都很多。</p><p>这是一个复杂的分布式计算框架，跟 map reduce 不一样的地方，这里不是分片了暴力扫数据，shuffle 然后汇总的简单计算模型。这里可能会利用索引，利用统计信息，数据库领域几十年优化的经验，会跟分布式计算紧密地结合在一起。</p><p>把执行器逻辑层的单节点扩到多节点，开发真正的分布式执行器层，这也是一个有挑战并且很大的事情，路漫漫其修远兮。</p><h2>优化器，统计信息，Join reorder</h2><p>都列到这一坨了。优化器这边，从最开始非常 naive 的基于规则的优化，到后面有了基于代价的优化。再然后统计信息也做得越来越完善，越来越准确。</p><p>现在优化器这边比较稳定下来了，统计信息方面也支持自动的做 analyze，并且根据查询反馈去动态的更新。抛开学术不谈，至少在工程层面，这些问题绝对是处于技术前沿了的。</p><p>所以这就完了？不，挑战才刚开始！这里有两个问题核心，一个是数据量估算的准不估，另一个是代价算的对不对。统计信息是估算准不准的问题，而代价对不对就更难衡量。CPU 磁盘IO 内存，网络，到底分别占多少比重呢？比如一个逆序扫磁盘，跟顺序扫盘，代价就不是一个级别。比如一个场景走索引需要两次网络，而扫表要扫的区域是N条记录，N多大的时候代价是小于走网络的？ 其实这些很多都是拍脑袋拍的，如何让玄学调参尽量地少一点。优化器能不能更智能一些，把一些写得比较弱智的子查询，直接转化得跟DBA优化过的一样高效。</p><p>还有就是 join reorder 一块盲区，目前没有根据代价来算。有时候为了达到最佳效果，还要手动去调整顺序。</p><h2>数据分布和调度</h2><p>我们专门有一个子系统，负责集群的数据分布和调度，它就是 pd。外界往往对 pd 了解的最少，其实它是非常关键的。</p><p>先说数据分布。存储在逻辑上是一个大的 kv 数据库，table 和 索引都会映射到一部分的 kv 范围。按照 kv 的 range，整个存储被划分为一个一个的 region。逻辑层面的 region，跟物理层面的节点，会形成一个映射关系。pd 做的事情，就是管理这个映射关系。假设一张表很大的情况下，它会涉及好多个 region，region 最终会散布在各个节点上面，于是请求就分散到各个节点上了。如果表很小呢？它会只包含一个 region，这个表被频繁访问，那这个 region 对就的节点就可能变成热点了。</p><p>数据分布是动态的，由 pd 调度。我们希望 region 在节点上的分布要尽量地均匀，于是流量也会分散开。但实际上呢？ 不同 region 被访问的模式其实是不一样的。数据有冷有热，部分 region 可能被频繁在访问，而部分则很少被访问到。那么，调度就不能单考虑均匀，还得照顾到热点，将热点打散。</p><p>由于 region 分布不同，不同机器的磁盘空间占用可能不一样，这又是一个考虑因素。如果疯狂的往某个机器上调度，那个机器的盘也许就被写爆了，这又是要考虑到的点。</p><p>还有，要考虑到 raft group 的安全性，每个 region 默认是三副本的。那么，就要考虑单节点 down 机，或者整机架，甚至是机房的故障， region 的副本就需要交错着放。出个题目，这个可靠性的概率怎么算？ 节点挂掉时，还有需要被副本之类的操作。加节点也是涉及调度。</p><p>单考虑一个因素时，问题并不复杂。但是要考虑到许多种策略时，pd 那边数据分布和调度的事情就变成了一个比较麻烦的问题。如果评估某个策略和算法是有效的？如果模拟真实的情况，去验证一个新的策略？</p><h2>存储和性能</h2><p>存储是一直要优化的方向，对性能的追求没有极致。从最早尝试使用 hbase 到后来决定自研分布式存储 TiKV。从最早的每一行的一个列作为一条 kv 记录，然后改到行存，每一行作为一条 kv 记录，都是在存储模型方面做过的调整和探索。</p><p>还有针对业务特点的各种细化，比如实现事务时，要写锁记录，要写 MVCC 数据。其实对不同模型的请求，写操作的特征是很不一样的。锁数据的存在时间很短，写数据成功后马上就删除，而 MVCC 数据要一直保存。于是我们利用 rocksdb 的 column family，把锁和数据放到不同的 column family，并且对应设置不同的 compaction 策略，调整不同的参数。早期都是把性能几倍几十倍的往上提升的。</p><p>业务一些细节还有很多，比如我们切分 region 按大小来，是否就合理。同样大小 64M 的 region，存放数据，跟存放索引，其实记录条数相差还是比较大的，那么同样是扫一个 region 工作量就会相差较大，这又会让多个 worker 分配工作量时划分不太均匀。比如一个 index scan，读数据读完了，读索引还是慢悠悠的做，那就会有不必要的等待。另外，不同 region 的大小又会有什么影响呢？ 跟数据打散的程度会有什么关联性？ 还有，不同大小对于 snapshot 或者对于 pd 的心跳方面会存在什么影响？</p><p>LSM 的删除，compaction 的代价还是挺大的，抖动也会比较影响。rocksdb 里面的各种细节参数多如牛毛，这也是需要大牛来&quot;玄学调参&quot;的，都是要求对里面的实现细节都了如指掌。</p><p>对于新技术的调研，这边也没有落下。就说说写放大，在 MVCC 那一层，要写入不同的版本，MVCC 是一次放大。到了 raft 那边，多副本的存在，会将写再放大几倍。再到 rocksdb 存储，其本身又是有 kv 的版本的。删除操作并不是物理删除，而是追加写一个版本。后台的 compaction 之前的“高效”写入的副作用了，尤其是要一层一层的做下去，这里面是巨大的放大。TiDB 里面设置了事务大小限制的，部分原因就是上层的事务被放大很多倍，大块写入很快就会把磁盘的 IO 耗尽。那么，如果能把 LSM 的 key 跟 value 分离开来，在 LSM 里面只存 key，写放大就会大大的减少，badger 就是这么做的，还有 rocksdb 的新 feature blobdb 也有这个。我们会测试各种不同的写入大小，64,128,256 等等，各种不同的读写模式，顺序的，随机的，去跟 rocksdb 对比，结果各有优劣吧。那么，能否让大的 kv，我们用 kv 分离的方式存，而对小的 kv 我们仍然是整体写 LSM？</p><p>我们一直都还没把 raft log 的存储独立出来。其实 raft log 存储的业务特点是很明显的，就是日志和快照。日志就是一个队列，并且是没有修改操作的。rocksdb 并不是特别优化的场景，是否可以订制化这种业务模型的存储，从而提升性能呢？</p><hr /><p>TiDB 招人很难。这篇打个<a href="https://pingcap.com/recruit-cn/">招骋广告</a>。</p><p>说了这么多（发现一扯淡就收不住了），有没有动心了？ 快到碗里来（内推 mkl@pingcap.com）。</p></div><div><a href="/tags/TiDB" class="btn btn-info btn-xs">TiDB</a><ul class="pager" /></div></div><div class="col-sm-3" id="sidebar" role="navigation"><div class="well sidebar-nav"><h2 id="nav-pills">Category</h2><ul class="nav nav-pills nav-stacked"><li><a href="/category/编译器">编译器</a></li><li><a href="/category/编程语言">编程语言</a></li><li><a href="/category/高性能服务器">高性能服务器</a></li><li><a href="/category/分布式">分布式</a></li><li><a href="/category/Android游戏开发">Android游戏开发</a></li></ul><h2 id="nav-pills">Tags</h2><a href="/tags/lisp" class="btn btn-info btn-xs">lisp</a><a href="/tags/源代码分析" class="btn btn-info btn-xs">源代码分析</a><a href="/tags/chibi-scheme" class="btn btn-info btn-xs">chibi-scheme</a><a href="/tags/golang" class="btn btn-info btn-xs">golang</a><a href="/tags/rbtree" class="btn btn-info btn-xs">rbtree</a><a href="/tags/mempool" class="btn btn-info btn-xs">mempool</a><a href="/tags/hash" class="btn btn-info btn-xs">hash</a><a href="/tags/task" class="btn btn-info btn-xs">task</a><a href="/tags/协程" class="btn btn-info btn-xs">协程</a><a href="/tags/skynet" class="btn btn-info btn-xs">skynet</a><a href="/tags/beansdb" class="btn btn-info btn-xs">beansdb</a><a href="/tags/actor模型" class="btn btn-info btn-xs">actor模型</a><a href="/tags/lease" class="btn btn-info btn-xs">lease</a><a href="/tags/paxos" class="btn btn-info btn-xs">paxos</a><a href="/tags/面试题" class="btn btn-info btn-xs">面试题</a><a href="/tags/linux" class="btn btn-info btn-xs">linux</a><a href="/tags/org-mode" class="btn btn-info btn-xs">org-mode</a><a href="/tags/blog" class="btn btn-info btn-xs">blog</a><a href="/tags/编码" class="btn btn-info btn-xs">编码</a><a href="/tags/java" class="btn btn-info btn-xs">java</a><a href="/tags/地图编辑器" class="btn btn-info btn-xs">地图编辑器</a><a href="/tags/关卡生成" class="btn btn-info btn-xs">关卡生成</a><a href="/tags/tiled" class="btn btn-info btn-xs">tiled</a><a href="/tags/primitive" class="btn btn-info btn-xs">primitive</a><a href="/tags/scheme" class="btn btn-info btn-xs">scheme</a><a href="/tags/petrescue" class="btn btn-info btn-xs">petrescue</a><a href="/tags/读书笔记" class="btn btn-info btn-xs">读书笔记</a><a href="/tags/eopl" class="btn btn-info btn-xs">eopl</a><a href="/tags/CAS" class="btn btn-info btn-xs">CAS</a><a href="/tags/无锁" class="btn btn-info btn-xs">无锁</a><a href="/tags/数据结构" class="btn btn-info btn-xs">数据结构</a><a href="/tags/FP" class="btn btn-info btn-xs">FP</a><a href="/tags/多值返回" class="btn btn-info btn-xs">多值返回</a><a href="/tags/lambda" class="btn btn-info btn-xs">lambda</a><a href="/tags/AssetManager" class="btn btn-info btn-xs">AssetManager</a><a href="/tags/libgdx" class="btn btn-info btn-xs">libgdx</a><a href="/tags/pprof" class="btn btn-info btn-xs">pprof</a><a href="/tags/微博数据分析" class="btn btn-info btn-xs">微博数据分析</a><a href="/tags/cdn" class="btn btn-info btn-xs">cdn</a><a href="/tags/云风" class="btn btn-info btn-xs">云风</a><a href="/tags/hive" class="btn btn-info btn-xs">hive</a><a href="/tags/调度器" class="btn btn-info btn-xs">调度器</a><a href="/tags/flash" class="btn btn-info btn-xs">flash</a><a href="/tags/planeshift" class="btn btn-info btn-xs">planeshift</a><a href="/tags/分段栈" class="btn btn-info btn-xs">分段栈</a><a href="/tags/terminal" class="btn btn-info btn-xs">terminal</a><a href="/tags/godit" class="btn btn-info btn-xs">godit</a><a href="/tags/转载" class="btn btn-info btn-xs">转载</a><a href="/tags/OpenGL" class="btn btn-info btn-xs">OpenGL</a><a href="/tags/年终总结" class="btn btn-info btn-xs">年终总结</a><a href="/tags/翻译" class="btn btn-info btn-xs">翻译</a><a href="/tags/facebook" class="btn btn-info btn-xs">facebook</a><a href="/tags/编程感悟" class="btn btn-info btn-xs">编程感悟</a><a href="/tags/架构" class="btn btn-info btn-xs">架构</a><a href="/tags/C" class="btn btn-info btn-xs">C</a><a href="/tags/CSP" class="btn btn-info btn-xs">CSP</a><a href="/tags/acme" class="btn btn-info btn-xs">acme</a><a href="/tags/编辑器" class="btn btn-info btn-xs">编辑器</a><a href="/tags/devdraw" class="btn btn-info btn-xs">devdraw</a><a href="/tags/mmorpg" class="btn btn-info btn-xs">mmorpg</a><a href="/tags/ouster" class="btn btn-info btn-xs">ouster</a><a href="/tags/一致性" class="btn btn-info btn-xs">一致性</a><a href="/tags/翻墙" class="btn btn-info btn-xs">翻墙</a><a href="/tags/n6bagent" class="btn btn-info btn-xs">n6bagent</a><a href="/tags/性能优化" class="btn btn-info btn-xs">性能优化</a><a href="/tags/继承" class="btn btn-info btn-xs">继承</a><a href="/tags/接口" class="btn btn-info btn-xs">接口</a><a href="/tags/DSP" class="btn btn-info btn-xs">DSP</a><a href="/tags/aerospike" class="btn btn-info btn-xs">aerospike</a><a href="/tags/kv" class="btn btn-info btn-xs">kv</a><a href="/tags/ssd" class="btn btn-info btn-xs">ssd</a><a href="/tags/raft" class="btn btn-info btn-xs">raft</a><a href="/tags/overcommit" class="btn btn-info btn-xs">overcommit</a><a href="/tags/nosql" class="btn btn-info btn-xs">nosql</a><a href="/tags/coroutine" class="btn btn-info btn-xs">coroutine</a><a href="/tags/plan9" class="btn btn-info btn-xs">plan9</a><a href="/tags/grt" class="btn btn-info btn-xs">grt</a><a href="/tags/database" class="btn btn-info btn-xs">database</a><a href="/tags/垃圾回收" class="btn btn-info btn-xs">垃圾回收</a><a href="/tags/lambda演算" class="btn btn-info btn-xs">lambda演算</a><a href="/tags/网络编程" class="btn btn-info btn-xs">网络编程</a><a href="/tags/epoll" class="btn btn-info btn-xs">epoll</a><a href="/tags/select" class="btn btn-info btn-xs">select</a><a href="/tags/io模型" class="btn btn-info btn-xs">io模型</a><a href="/tags/阻塞" class="btn btn-info btn-xs">阻塞</a><a href="/tags/同步" class="btn btn-info btn-xs">同步</a><a href="/tags/dynomite" class="btn btn-info btn-xs">dynomite</a><a href="/tags/session" class="btn btn-info btn-xs">session</a><a href="/tags/beego" class="btn btn-info btn-xs">beego</a><a href="/tags/codis" class="btn btn-info btn-xs">codis</a><a href="/tags/ycombinator" class="btn btn-info btn-xs">ycombinator</a><a href="/tags/热重启" class="btn btn-info btn-xs">热重启</a><a href="/tags/跳表" class="btn btn-info btn-xs">跳表</a><a href="/tags/skiplist" class="btn btn-info btn-xs">skiplist</a><a href="/tags/监控" class="btn btn-info btn-xs">监控</a><a href="/tags/zipkin" class="btn btn-info btn-xs">zipkin</a><a href="/tags/influxdb" class="btn btn-info btn-xs">influxdb</a><a href="/tags/heka" class="btn btn-info btn-xs">heka</a><a href="/tags/分布式跟踪" class="btn btn-info btn-xs">分布式跟踪</a><a href="/tags/bug" class="btn btn-info btn-xs">bug</a><a href="/tags/gorilla" class="btn btn-info btn-xs">gorilla</a><a href="/tags/middleware" class="btn btn-info btn-xs">middleware</a><a href="/tags/http" class="btn btn-info btn-xs">http</a><a href="/tags/object" class="btn btn-info btn-xs">object</a><a href="/tags/closure" class="btn btn-info btn-xs">closure</a><a href="/tags/nanopass" class="btn btn-info btn-xs">nanopass</a><a href="/tags/位运算" class="btn btn-info btn-xs">位运算</a><a href="/tags/swapcontext" class="btn btn-info btn-xs">swapcontext</a><a href="/tags/汇编" class="btn btn-info btn-xs">汇编</a><a href="/tags/trampoline" class="btn btn-info btn-xs">trampoline</a><a href="/tags/cps" class="btn btn-info btn-xs">cps</a><a href="/tags/continuation" class="btn btn-info btn-xs">continuation</a><a href="/tags/callback" class="btn btn-info btn-xs">callback</a><a href="/tags/closure-convert" class="btn btn-info btn-xs">closure-convert</a><a href="/tags/redis" class="btn btn-info btn-xs">redis</a><a href="/tags/逻辑时钟" class="btn btn-info btn-xs">逻辑时钟</a><a href="/tags/logical clock" class="btn btn-info btn-xs">logical clock</a><a href="/tags/服务发现" class="btn btn-info btn-xs">服务发现</a><a href="/tags/配置中心" class="btn btn-info btn-xs">配置中心</a><a href="/tags/chicken" class="btn btn-info btn-xs">chicken</a><a href="/tags/调试" class="btn btn-info btn-xs">调试</a><a href="/tags/VM" class="btn btn-info btn-xs">VM</a><a href="/tags/srfi-18" class="btn btn-info btn-xs">srfi-18</a><a href="/tags/call/cc" class="btn btn-info btn-xs">call/cc</a><a href="/tags/p2p" class="btn btn-info btn-xs">p2p</a><a href="/tags/delivery" class="btn btn-info btn-xs">delivery</a><a href="/tags/动态规划" class="btn btn-info btn-xs">动态规划</a><a href="/tags/网络" class="btn btn-info btn-xs">网络</a><a href="/tags/lua" class="btn btn-info btn-xs">lua</a><a href="/tags/sql" class="btn btn-info btn-xs">sql</a><a href="/tags/cockroachdb" class="btn btn-info btn-xs">cockroachdb</a><a href="/tags/isolation" class="btn btn-info btn-xs">isolation</a><a href="/tags/snapshot" class="btn btn-info btn-xs">snapshot</a><a href="/tags/serializable" class="btn btn-info btn-xs">serializable</a><a href="/tags/链表" class="btn btn-info btn-xs">链表</a><a href="/tags/ltask" class="btn btn-info btn-xs">ltask</a><a href="/tags/channel" class="btn btn-info btn-xs">channel</a><a href="/tags/leetcode" class="btn btn-info btn-xs">leetcode</a><a href="/tags/Rust" class="btn btn-info btn-xs">Rust</a><a href="/tags/socket" class="btn btn-info btn-xs">socket</a><a href="/tags/interpret" class="btn btn-info btn-xs">interpret</a><a href="/tags/可串行化" class="btn btn-info btn-xs">可串行化</a><a href="/tags/spanner" class="btn btn-info btn-xs">spanner</a><a href="/tags/分布式" class="btn btn-info btn-xs">分布式</a><a href="/tags/transaction" class="btn btn-info btn-xs">transaction</a><a href="/tags/SQL" class="btn btn-info btn-xs">SQL</a><a href="/tags/parser" class="btn btn-info btn-xs">parser</a><a href="/tags/内存池" class="btn btn-info btn-xs">内存池</a><a href="/tags/allocator" class="btn btn-info btn-xs">allocator</a><a href="/tags/combinator" class="btn btn-info btn-xs">combinator</a><a href="/tags/monad" class="btn btn-info btn-xs">monad</a><a href="/tags/ocaml" class="btn btn-info btn-xs">ocaml</a><a href="/tags/abstract machine" class="btn btn-info btn-xs">abstract machine</a><a href="/tags/ZINC" class="btn btn-info btn-xs">ZINC</a><a href="/tags/currying" class="btn btn-info btn-xs">currying</a><a href="/tags/type infer" class="btn btn-info btn-xs">type infer</a><a href="/tags/HM" class="btn btn-info btn-xs">HM</a><a href="/tags/类型系统" class="btn btn-info btn-xs">类型系统</a><a href="/tags/leak" class="btn btn-info btn-xs">leak</a><a href="/tags/reset" class="btn btn-info btn-xs">reset</a><a href="/tags/shift" class="btn btn-info btn-xs">shift</a><a href="/tags/delimited" class="btn btn-info btn-xs">delimited</a><a href="/tags/dectect" class="btn btn-info btn-xs">dectect</a><a href="/tags/race" class="btn btn-info btn-xs">race</a><a href="/tags/schema" class="btn btn-info btn-xs">schema</a><a href="/tags/hybrid logical clock" class="btn btn-info btn-xs">hybrid logical clock</a><a href="/tags/memory" class="btn btn-info btn-xs">memory</a><a href="/tags/TiDB" class="btn btn-info btn-xs">TiDB</a><a href="/tags/pattern match" class="btn btn-info btn-xs">pattern match</a><a href="/tags/shen" class="btn btn-info btn-xs">shen</a><a href="/tags/context" class="btn btn-info btn-xs">context</a><a href="/tags/缤果盒子" class="btn btn-info btn-xs">缤果盒子</a><a href="/tags/variant" class="btn btn-info btn-xs">variant</a><a href="/tags/pool" class="btn btn-info btn-xs">pool</a><a href="/tags/goroutine" class="btn btn-info btn-xs">goroutine</a><a href="/tags/morestack" class="btn btn-info btn-xs">morestack</a><a href="/tags/RC" class="btn btn-info btn-xs">RC</a><a href="/tags/SI" class="btn btn-info btn-xs">SI</a><a href="/tags/opentracing" class="btn btn-info btn-xs">opentracing</a><a href="/tags/klambda" class="btn btn-info btn-xs">klambda</a><a href="/tags/优化" class="btn btn-info btn-xs">优化</a><a href="/tags/Cello" class="btn btn-info btn-xs">Cello</a><a href="/tags/fat pointer" class="btn btn-info btn-xs">fat pointer</a><a href="/tags/eval" class="btn btn-info btn-xs">eval</a><a href="/tags/ddl" class="btn btn-info btn-xs">ddl</a><a href="/tags/codegen" class="btn btn-info btn-xs">codegen</a><a href="/tags/expression" class="btn btn-info btn-xs">expression</a><a href="/tags/erlang" class="btn btn-info btn-xs">erlang</a><a href="/tags/withcancel" class="btn btn-info btn-xs">withcancel</a><a href="/tags/constant propagate" class="btn btn-info btn-xs">constant propagate</a><a href="/tags/KISS" class="btn btn-info btn-xs">KISS</a><a href="/tags/性能" class="btn btn-info btn-xs">性能</a><a href="/tags/macro" class="btn btn-info btn-xs">macro</a><a href="/tags/hygiene" class="btn btn-info btn-xs">hygiene</a><a href="/tags/er-macro-transform" class="btn btn-info btn-xs">er-macro-transform</a><a href="/tags/cora" class="btn btn-info btn-xs">cora</a><a href="/tags/module" class="btn btn-info btn-xs">module</a><a href="/tags/错误处理" class="btn btn-info btn-xs">错误处理</a><a href="/tags/contract" class="btn btn-info btn-xs">contract</a><a href="/tags/union store" class="btn btn-info btn-xs">union store</a><a href="/tags/calvin" class="btn btn-info btn-xs">calvin</a><a href="/tags/bytecode" class="btn btn-info btn-xs">bytecode</a><a href="/tags/JVM" class="btn btn-info btn-xs">JVM</a><a href="/tags/aurora" class="btn btn-info btn-xs">aurora</a><a href="/tags/tidb" class="btn btn-info btn-xs">tidb</a><a href="/tags/vm" class="btn btn-info btn-xs">vm</a><a href="/tags/executor" class="btn btn-info btn-xs">executor</a><a href="/tags/covariance" class="btn btn-info btn-xs">covariance</a><a href="/tags/GC" class="btn btn-info btn-xs">GC</a><a href="/tags/oberon" class="btn btn-info btn-xs">oberon</a><a href="/tags/sysbench" class="btn btn-info btn-xs">sysbench</a><a href="/tags/effect" class="btn btn-info btn-xs">effect</a><a href="/tags/await" class="btn btn-info btn-xs">await</a><a href="/tags/async" class="btn btn-info btn-xs">async</a><a href="/tags/promise" class="btn btn-info btn-xs">promise</a><a href="/tags/interface" class="btn btn-info btn-xs">interface</a><a href="/tags/privilege" class="btn btn-info btn-xs">privilege</a><a href="/tags/test" class="btn btn-info btn-xs">test</a><a href="/tags/inferno" class="btn btn-info btn-xs">inferno</a><a href="/tags/microKanren" class="btn btn-info btn-xs">microKanren</a><a href="/tags/miniKanren" class="btn btn-info btn-xs">miniKanren</a><a href="/tags/zenlife" class="btn btn-info btn-xs">zenlife</a><a href="/tags/domain" class="btn btn-info btn-xs">domain</a><a href="/tags/HLC" class="btn btn-info btn-xs">HLC</a><a href="/tags/distributed" class="btn btn-info btn-xs">distributed</a><a href="/tags/deadlock" class="btn btn-info btn-xs">deadlock</a><a href="/tags/encrypt" class="btn btn-info btn-xs">encrypt</a><a href="/tags/authentication" class="btn btn-info btn-xs">authentication</a><a href="/tags/binlog" class="btn btn-info btn-xs">binlog</a><a href="/tags/probability" class="btn btn-info btn-xs">probability</a><a href="/tags/hotspot" class="btn btn-info btn-xs">hotspot</a><a href="/tags/makefile" class="btn btn-info btn-xs">makefile</a><a href="/tags/cache" class="btn btn-info btn-xs">cache</a><a href="/tags/ffi" class="btn btn-info btn-xs">ffi</a><a href="/tags/itx" class="btn btn-info btn-xs">itx</a><a href="/tags/prepare" class="btn btn-info btn-xs">prepare</a><a href="/tags/code review" class="btn btn-info btn-xs">code review</a><a href="/tags/darkeden" class="btn btn-info btn-xs">darkeden</a><a href="/tags/dependent" class="btn btn-info btn-xs">dependent</a><a href="/tags/type" class="btn btn-info btn-xs">type</a><a href="/tags/koka" class="btn btn-info btn-xs">koka</a><a href="/tags/引用计数" class="btn btn-info btn-xs">引用计数</a><a href="/tags/algebraic effect" class="btn btn-info btn-xs">algebraic effect</a><a href="/tags/RWMutex" class="btn btn-info btn-xs">RWMutex</a><a href="/tags/软件工程" class="btn btn-info btn-xs">软件工程</a><a href="/tags/开发环境" class="btn btn-info btn-xs">开发环境</a><a href="/tags/code generation" class="btn btn-info btn-xs">code generation</a><a href="/tags/CI" class="btn btn-info btn-xs">CI</a><a href="/tags/regex" class="btn btn-info btn-xs">regex</a><a href="/tags/PEG" class="btn btn-info btn-xs">PEG</a><a href="/tags/architecture" class="btn btn-info btn-xs">architecture</a><a href="/tags/cloud native" class="btn btn-info btn-xs">cloud native</a><a href="/tags/gambit" class="btn btn-info btn-xs">gambit</a><a href="/tags/ebpf" class="btn btn-info btn-xs">ebpf</a><a href="/tags/bpftrace" class="btn btn-info btn-xs">bpftrace</a><a href="/tags/流控" class="btn btn-info btn-xs">流控</a><a href="/tags/oom" class="btn btn-info btn-xs">oom</a><a href="/tags/severless" class="btn btn-info btn-xs">severless</a><a href="/tags/coprocessor" class="btn btn-info btn-xs">coprocessor</a><a href="/tags/treadmill" class="btn btn-info btn-xs">treadmill</a><a href="/tags/MVCC" class="btn btn-info btn-xs">MVCC</a><a href="/tags/hole digging" class="btn btn-info btn-xs">hole digging</a><a href="/tags/NAT" class="btn btn-info btn-xs">NAT</a><a href="/tags/reverse proxying" class="btn btn-info btn-xs">reverse proxying</a><a href="/tags/tunnel" class="btn btn-info btn-xs">tunnel</a><a href="/tags/累积分布函数" class="btn btn-info btn-xs">累积分布函数</a><a href="/tags/eCDF" class="btn btn-info btn-xs">eCDF</a><a href="/tags/SEDA" class="btn btn-info btn-xs">SEDA</a><a href="/tags/top-of-stack-caching" class="btn btn-info btn-xs">top-of-stack-caching</a><a href="/tags/exception" class="btn btn-info btn-xs">exception</a><a href="/tags/resumable" class="btn btn-info btn-xs">resumable</a><a href="/tags/string" class="btn btn-info btn-xs">string</a><a href="/tags/ActivityPub" class="btn btn-info btn-xs">ActivityPub</a><a href="/tags/mastodon" class="btn btn-info btn-xs">mastodon</a><a href="/tags/schedule" class="btn btn-info btn-xs">schedule</a><a href="/tags/concurrent" class="btn btn-info btn-xs">concurrent</a><a href="/tags/lru" class="btn btn-info btn-xs">lru</a><a href="/tags/scale" class="btn btn-info btn-xs">scale</a><a href="/tags/recursive" class="btn btn-info btn-xs">recursive</a><a href="/tags/patch" class="btn btn-info btn-xs">patch</a><a href="/tags/go" class="btn btn-info btn-xs">go</a><a href="/tags/bazel" class="btn btn-info btn-xs">bazel</a><a href="/tags/union scan" class="btn btn-info btn-xs">union scan</a><a href="/tags/technical debt" class="btn btn-info btn-xs">technical debt</a><a href="/tags/library" class="btn btn-info btn-xs">library</a><a href="/tags/framework" class="btn btn-info btn-xs">framework</a><a href="/tags/queueing delay" class="btn btn-info btn-xs">queueing delay</a><a href="/tags/queueing theory" class="btn btn-info btn-xs">queueing theory</a><a href="/tags/queueing" class="btn btn-info btn-xs">queueing</a><a href="/tags/threaded-code" class="btn btn-info btn-xs">threaded-code</a><a href="/tags/jit" class="btn btn-info btn-xs">jit</a><a href="/tags/copy-and-patch" class="btn btn-info btn-xs">copy-and-patch</a><a href="/tags/fips" class="btn btn-info btn-xs">fips</a><a href="/tags/delimited-continuation" class="btn btn-info btn-xs">delimited-continuation</a><a href="/tags/tailfication" class="btn btn-info btn-xs">tailfication</a><a href="/tags/clean code" class="btn btn-info btn-xs">clean code</a><a href="/tags/design" class="btn btn-info btn-xs">design</a><a href="/tags/AI" class="btn btn-info btn-xs">AI</a><a href="/tags/软件事务内存" class="btn btn-info btn-xs">软件事务内存</a><a href="/tags/STM" class="btn btn-info btn-xs">STM</a><a href="/tags/debugger" class="btn btn-info btn-xs">debugger</a><a href="/tags/namebase" class="btn btn-info btn-xs">namebase</a><a href="/tags/r7rs" class="btn btn-info btn-xs">r7rs</a><a href="/tags/namespace" class="btn btn-info btn-xs">namespace</a><a href="/tags/package" class="btn btn-info btn-xs">package</a><a href="/tags/mark-sweep" class="btn btn-info btn-xs">mark-sweep</a><a href="/tags/mostly-copying" class="btn btn-info btn-xs">mostly-copying</a><a href="/tags/tailcall" class="btn btn-info btn-xs">tailcall</a><a href="/tags/cml" class="btn btn-info btn-xs">cml</a><a href="/tags/type checker" class="btn btn-info btn-xs">type checker</a><a href="/tags/gc" class="btn btn-info btn-xs">gc</a><a href="/tags/am40" class="btn btn-info btn-xs">am40</a><a href="/tags/旁路由" class="btn btn-info btn-xs">旁路由</a><a href="/tags/nas" class="btn btn-info btn-xs">nas</a><a href="/tags/tracing" class="btn btn-info btn-xs">tracing</a><a href="/tags/multicore" class="btn btn-info btn-xs">multicore</a><a href="/tags/concurrency" class="btn btn-info btn-xs">concurrency</a><a href="/tags/rust" class="btn btn-info btn-xs">rust</a><a href="/tags/cranelift" class="btn btn-info btn-xs">cranelift</a><a href="/tags/c" class="btn btn-info btn-xs">c</a></div></div></div></div><hr /><footer><p class="nav navbar-nav navbar-right">Powered by <a href="https://clojure.org/">Clojure</a> &amp; <a href="//getbootstrap.com/">Bootstrap</a></p></footer></body></html>