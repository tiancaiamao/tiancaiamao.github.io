<html lang="zh_CN"><head><meta charset="utf-8" /><title>Go的代码调优一例</title><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" /></head><body><div class="navbar navbar-inverse"><div class="container"><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href="/">Home</a></li><li><a href="/index">Blog</a></li><li><a href="/project">Project</a></li><li><a href="/about">About</a></li><li><a href="/feed.atom">Rss</a></li></ul></div></div></div><div class="container"><div class="row row-offcanvas row-offcanvas-right"><div class="col-sm-9"><div id="content"><h1 id="Title">Go的代码调优一例</h1><p>2014-08-05</p><p>用tcpcopy导的线上流量，活动数据库也是真实的数据，这是我抓的一份pprof：</p><pre><code>genius@geniuss-Macbook-air:~/project/src/dsp_masky $go tool pprof ls.prof 
Welcome to pprof!  For help, type 'help'.
(pprof) top
Total: 14413 samples
    1342   9.3%   9.3%     1342   9.3% strconv.ParseUint
    1243   8.6%  17.9%     1243   8.6% runtime.duffcopy
    1082   7.5%  25.4%     5067  35.2% dsp_masky/model/bid.(*BidServer).FilterByCampaign
    1073   7.4%  32.9%     1824  12.7% runtime.mallocgc
     638   4.4%  37.3%      638   4.4% runtime.MSpan_Sweep
     555   3.9%  41.2%      555   3.9% settype
     547   3.8%  45.0%      547   3.8% runtime.mapaccess2_fast64
     513   3.6%  48.5%     1855  12.9% strconv.ParseInt
     376   2.6%  51.1%      452   3.1% regexp.(*machine).add
     337   2.3%  53.5%     2418  16.8% dsp_masky/model.regionQuery
</code></pre><p>消耗排前三的函数分别是ParseUint，duffcopy，FilterByCampaign。下面一条一条的分析。</p><h1>优化duffcopy</h1><p>我查了一下duffcopy这个函数，是一个类似memcopy的函数，将内存从一块复制到另一块。这个函数并没有由runtime中的任何库函数调用到，它是编译器生成的代码直接调用的。
为什么duffcopy如此之高？我在看mentor的编程习惯的时候找到了原因：</p><pre><code>var RCampaign map[int64]Campaign
</code></pre><p>RCampaign是一个全内存的活动数据库，注意到它使用的存储是<code>Campaign</code>而不是<code>*Campaign</code>，其中<code>Campaign</code>的定义是这样子的，很大的一个结构体：</p><pre><code>type Campaign struct {
    Id                int64
    Plan              CPlan
    PublisherId       int
    CreateUserId      int64
    WardenStatus      int
    Zone              []Zone
    IpSections        []IpSection
    ChannelId         int64
    AdxId             int64
    CategoryId        []int
    TopPrice          float64
    SubPrice          SubCharge
    PositionPrice     map[int64]ChargePrice
    ChargePrice       float64
    ChargeType        int
    Gaga              FilterGaga
    MediaFilter       MediaFilter
    OType             int
    FrequencyFilters  []model.FrequencyFilter
    AMonit            []string
    Character         []model.ActionTerm
    ...
}
</code></pre><p>mentor平素是这样子写代码的：</p><pre><code>func ConvertCampaign(campaignInfo model.Campaign) (campaign Campaign, err error) {	//直接返回这么大的结构体
campaigns[Id] = campaign	//直接整个结构体赋值到map中
</code></pre><p>类似的例子还有很多，这些都会造成整份的数据拷贝，正是这样的编程习惯导致了duffcopy函数消耗了8.6%的CPU！</p><p>推荐的一个好的习惯是，稍大的类型存到map都存储指针而不是值。</p><p>下面是优掉掉duffcopy之后抓的一份pprof：</p><pre><code>Total: 12507 samples
    1739  13.9%  13.9%     1739  13.9% strconv.ParseUint
    1290  10.3%  24.2%     8282  66.2% dsp_masky/model/bid.(*BidServer).FilterByCampaign
     813   6.5%  30.7%      906   7.2% runtime.mapaccess2_fast64
     705   5.6%  36.4%     2444  19.5% strconv.ParseInt
     440   3.5%  39.9%      523   4.2% regexp.(*machine).add
     402   3.2%  43.1%     1202   9.6% hash_insert
     394   3.2%  46.2%     3136  25.1% dsp_masky/model.regionQuery
     305   2.4%  48.7%     2737  21.9% strconv.Atoi
     305   2.4%  51.1%      316   2.5% syscall.Syscall
     288   2.3%  53.4%     1027   8.2% runtime.mallocgc
</code></pre><h1>优化ParseUint</h1><p>这是我们实时竞价服务，每秒会有大量的请求到达。在每一次请求中，需要遍历所有活动，挑选出跟这次曝光机会相匹配的，参与竞价。其中有一项是地域信息，请求中会包含IP来源。而活动中是有地域信息，通过IP查询到用户所属地域，然后跟活动中地域进行比较。</p><p>问题出在地域使用的结构体上，活动中存储是用string表示的：</p><pre><code>type Zone struct {
    CountryId string
    RegionId  string
    CityId    string
}
</code></pre><p>而由IP得到的地域是用int表示的。所以比较两者是否匹配时，会用<code>strconv.Atoi</code>进行转换，这个函数调用了ParseUint。</p><p>当前的活动数量是2000，其中实际参与比较的是400个，然后每次比较会调用三次字符串转换操作，假设QPS当前是1500，那么400*3*1500将产生1,800,000次的ParseUint调用。这就是ParseUint函数会占用这么高CPU的原因了。</p><p>所以，我将Zone的存储结构调整为int后，避免了ParseUint函数。优化掉ParseUint之后，得到的pprof是这样子的：</p><pre><code>(pprof) top
Total: 4554 samples
     426   9.4%   9.4%      480  10.5% runtime.mapaccess2_fast64
     232   5.1%  14.4%     1768  38.8% dsp_masky/model/bid.(*BidServer).FilterByCampaign
     216   4.7%  19.2%      216   4.7% syscall.Syscall
     183   4.0%  23.2%      213   4.7% hash_insert
     167   3.7%  26.9%      167   3.7% ExternalCode
     141   3.1%  30.0%      222   4.9% runtime.mallocgc
     121   2.7%  32.6%      121   2.7% runtime.futex
     115   2.5%  35.2%      136   3.0% evacuate
     112   2.5%  37.6%      112   2.5% runtime.MSpan_Sweep
     103   2.3%  39.9%      103   2.3% runtime.aeshash64
</code></pre><p>刚拿到代码的时候观察，极限的时候大概会有2000多一点的QPS，在最高的流量压力下CPU占用甚至会超过700%，而做完这两个做化之后，再也没看到过CPU跑到500%以上。</p><h1>干掉defer</h1><p><code>mapaccess2_fast64</code>是由于<code>v, ok := m[key]</code>这种形式的map访问产生的。当前代码中非常大量地使用了map数据结构，而我看了一下相应的代码，大多使用都属于合理的范畴，所以这个方向很难优化下去。也许换成自己实现的hash会带来一定的提升，但是吃力不讨好的事情，暂时放着。</p><p>至于FilterByCampaign，对于每个曝光机会，需要与所有的活动的设定进行匹配，进行过滤，里面有一个大的<code>for range</code>循环很耗性能。除非算法级别的优化，否则这个大循环都避不开。但我暂时还没想到一个好的算法。</p><p>有点进展不顺了，于是去与mentor讨论。mentor提到，在加入了调价的一个更新之后，系统的CPU从原来的200%升到了400%的样子，让我可以去查一下这条路径的代码。然后我看到了defer，立马眼睛亮了：</p><pre><code> func (this *Campaign) GetPrice(positionId, size, host int64, b *BidServer) (price float64, err error) {
     ...
     defer func() {
         ...
     }()

     ...
     if err != nil {
         return
     }

     return
 }
</code></pre><p>这里有个明显的使用不当：如果返回err不为空，直接返回就可了，完全不需要执行defer函数，所以代码不应该这么写。而且，defer调用会有一定的开销。简要地说一下，首先defer需要把参数之类的东西先封装进一下结构体，跟函数一起，成为一个闭包，保存到defer链中。然后在函数返回时还会有一个defer链表的处理，以栈的顺序调用执行闭包函数。对于defer的垃圾回收等，也会有特殊的一些处理，总之，影响挺大。</p><p>GetPrice函数是代码路径中一个必然调用的函数，虽然没有循环，但是QPS上去之后，性能影响不可小嘘。优化完这里后观察，在大概1000左右QPS环境下，CPU使用率从优化前的200%左右，下降到了120%左右。</p><p>defer是性能杀手，我的原则是能不用尽量避开。</p><h1>time.Date</h1><p>现在看pprof是这样的：</p><pre><code>(pprof) top
Total: 3348 samples
     254   7.6%   7.6%      266   7.9% syscall.Syscall
     177   5.3%  12.9%      221   6.6% hash_next
     168   5.0%  17.9%     1320  39.4% dsp_masky/model/bid.(*BidServer).FilterByCampaign
     153   4.6%  22.5%      369  11.0% runtime.mallocgc
     153   4.6%  27.0%      194   5.8% runtime.mapaccess2_fast64
     113   3.4%  30.4%      113   3.4% time.absDate
     102   3.0%  33.5%      102   3.0% runtime.futex
      90   2.7%  36.1%      106   3.2% runtime.MSpan_Sweep
      83   2.5%  38.6%       83   2.5% runtime.aeshash64
      74   2.2%  40.8%       86   2.6% syscall.Syscall6
</code></pre><p>呐呢？<code>time.absDate</code>这个函数能占用到3.4%的性能？赶紧看代码：</p><pre><code> for _, campaignId := range campaignIds {
     //获取活动
     campaign, ok := RCampaign[campaignId]
     
     //排期
    now := time.Now()
    year, month, day := now.Date()
    day = year*10000 + int(month)*100 + day
</code></pre><p>改掉，移到for循环外面去，又找了一个问题，好happy。优化完之后的pprof：</p><pre><code>(pprof) top
Total: 3310 samples
     272   8.2%   8.2%      278   8.4% syscall.Syscall
     213   6.4%  14.7%      264   8.0% hash_next
     172   5.2%  19.8%      385  11.6% runtime.mallocgc
     163   4.9%  24.8%      215   6.5% runtime.mapaccess2_fast64
     155   4.7%  29.5%     1045  31.6% dsp_masky/model/bid.(*BidServer).FilterByCampaign
     143   4.3%  33.8%      143   4.3% runtime.futex
      90   2.7%  36.5%       90   2.7% runtime.aeshash64
      87   2.6%  39.1%      116   3.5% runtime.MSpan_Sweep
      67   2.0%  41.1%       82   2.5% settype
      66   2.0%  43.1%       66   2.0% runtime.findfunc
</code></pre><p>这个做完之后，1000QPS左右，CPU的使用率大概到了100%以内，相对上一次大概有个20%的情况优化。</p><h1>优化mallocgc</h1><p>mallocgc占了5.2%，这个是由于频繁内存分配导致的。跟着svg找到了mallocgc的来源，是由这个函数产生的：</p><pre><code>func (this *Campaign) GetPrice(positionId, size, host int64, b *BidServer) (price float64, err error) {
        offer = &amp;Offer{
            CampaignId: this.Id,
            UserId:     this.CreateUserId,
            Ctype:      this.ChargeType,
        }
        malloced = true
    }
    ...
}
</code></pre><p>每秒会来许多的请求，每来一条请求，都会对每个活动调用GetPrice进行价格方面的过滤，正是offer这个出价对象导致了大量的mallocgc。</p><p>既然找到了问题，就开始动手改。想法是，专门做一个Offer对象的分配池。</p><p>Go1.3提供了sync.Pool，我先用这个去实现，做了一个全局的<code>var OfferPool *sync.Pool</code>，然后每次分配从pool中去取。但...这是一次不成功的尝试。修改之后，我发现CPU利用率暴涨近一倍，pprof显示，大量的CPU时间耗在了Pool.Get函数中。</p><p>怎么可能做了对象的分配池，性能反而不如每次直接分配了呢？？？</p><p>思考之后，找到了原因。大量的CPU耗在Pool.Get中，里面是调用的CAP操作，抢‘锁’的状况很严重。原来，我做的是一个全局的pool，而每个请求都是在不同goroutine中，所以从pool中取对象时，抢锁浪费了大量的CPU，导致优化以后CPU反而暴增了。那么为什么mallocgc却没事呢？是因为它的锁的粒度小得多。mallocgc分配时，goroutine会先从本地的MCache中取内存，取不到时会到结体体M中取内存块，只有当M中出取不到时，才会去全局的内存分配池中取，所以不存在严重的竞争问题。</p><p>为了避开全局锁的问题，我改成了每个请求中附带一点Offer缓存，然后分配改成了下面的样子：</p><pre><code>var offer *Offer
if b.OfferPoolIndex &lt; len(b.OfferPool) {
    offer = &amp;b.OfferPool[b.OfferPoolIndex]
    b.OfferPoolIndex++
} else {
    offer = &amp;Offer{
        CampaignId: this.Id,
        UserId:     this.CreateUserId,
        Ctype:      this.ChargeType,
    }
}
</code></pre><p>由于之前已经优化过许多了，这个优化带来的提升不是很大了，大概在10%吧。目前观察到的1000QPS左右的CPU使用率大概在70-80%。再做下去已经性价比不高了，于是这次的优化工作到此结束！</p><hr /><p>更新：</p><p>后面测试发现，在优化ParseUint的时候修改代码引入了错误，导致过滤了很多的计算量。之后的继续优化中，相关数据失效，pprof不再能体现正确的方向。忧郁了~_~</p><h1>优化前后对比</h1><p>实验环境是开两个进程，一个跑优化前的代码，一个跑优化后的代码。用tcpcopy同时给两个进程导入线上真实流量观察。</p><h2>CPU利用率</h2><p>观察一段时间的两者CPU利用率，这是取样的一小段数据：</p><p>优化前：473 473 450 476 469 579 495</p><p>优化后：258 264 246 261 258 267 274</p><p>平均为原来的53.5%。</p><h2>内存</h2><p>使用比原来略有降低。</p><pre><code>优化前：{&quot;mem&quot;:&quot;508.8MB&quot;,&quot;ver&quot;:&quot;20140327~git-xxx&quot;,&quot;up_time&quot;:&quot;2014-08-04 18:02:55&quot;,&quot;total_count&quot;:50208025,&quot;last_10_second_qps&quot;:1119.800000}
优化后：{&quot;mem&quot;:&quot;431.6MB&quot;,&quot;ver&quot;:&quot;20140327~git-xxx&quot;,&quot;up_time&quot;:&quot;2014-08-05 12:12:43&quot;,&quot;total_count&quot;:9974904,&quot;last_10_second_qps&quot;:1056.700000}
</code></pre><h2>响应时间</h2><p>目前响应时间落在10ms以内是比较理想的。作为对比观察，tail取100000条日志记录，比较响应时间落在10/20/30ms区间上的记录条数</p><p>优化前：7309/1924/779</p><p>优化后：4220/1041/220</p></div><div><a href="/tags/golang" class="btn btn-info btn-xs">golang</a><a href="/tags/性能优化" class="btn btn-info btn-xs">性能优化</a><a href="/tags/pprof" class="btn btn-info btn-xs">pprof</a><ul class="pager" /></div></div><div class="col-sm-3" id="sidebar" role="navigation"><div class="well sidebar-nav"><h2 id="nav-pills">Category</h2><ul class="nav nav-pills nav-stacked"><li><a href="/category/编译器">编译器</a></li><li><a href="/category/编程语言">编程语言</a></li><li><a href="/category/高性能服务器">高性能服务器</a></li><li><a href="/category/分布式">分布式</a></li><li><a href="/category/Android游戏开发">Android游戏开发</a></li></ul><h2 id="nav-pills">Tags</h2><a href="/tags/lisp" class="btn btn-info btn-xs">lisp</a><a href="/tags/源代码分析" class="btn btn-info btn-xs">源代码分析</a><a href="/tags/chibi-scheme" class="btn btn-info btn-xs">chibi-scheme</a><a href="/tags/golang" class="btn btn-info btn-xs">golang</a><a href="/tags/rbtree" class="btn btn-info btn-xs">rbtree</a><a href="/tags/mempool" class="btn btn-info btn-xs">mempool</a><a href="/tags/hash" class="btn btn-info btn-xs">hash</a><a href="/tags/task" class="btn btn-info btn-xs">task</a><a href="/tags/协程" class="btn btn-info btn-xs">协程</a><a href="/tags/skynet" class="btn btn-info btn-xs">skynet</a><a href="/tags/beansdb" class="btn btn-info btn-xs">beansdb</a><a href="/tags/actor模型" class="btn btn-info btn-xs">actor模型</a><a href="/tags/lease" class="btn btn-info btn-xs">lease</a><a href="/tags/paxos" class="btn btn-info btn-xs">paxos</a><a href="/tags/面试题" class="btn btn-info btn-xs">面试题</a><a href="/tags/linux" class="btn btn-info btn-xs">linux</a><a href="/tags/org-mode" class="btn btn-info btn-xs">org-mode</a><a href="/tags/blog" class="btn btn-info btn-xs">blog</a><a href="/tags/编码" class="btn btn-info btn-xs">编码</a><a href="/tags/java" class="btn btn-info btn-xs">java</a><a href="/tags/地图编辑器" class="btn btn-info btn-xs">地图编辑器</a><a href="/tags/关卡生成" class="btn btn-info btn-xs">关卡生成</a><a href="/tags/tiled" class="btn btn-info btn-xs">tiled</a><a href="/tags/primitive" class="btn btn-info btn-xs">primitive</a><a href="/tags/scheme" class="btn btn-info btn-xs">scheme</a><a href="/tags/petrescue" class="btn btn-info btn-xs">petrescue</a><a href="/tags/读书笔记" class="btn btn-info btn-xs">读书笔记</a><a href="/tags/eopl" class="btn btn-info btn-xs">eopl</a><a href="/tags/CAS" class="btn btn-info btn-xs">CAS</a><a href="/tags/无锁" class="btn btn-info btn-xs">无锁</a><a href="/tags/数据结构" class="btn btn-info btn-xs">数据结构</a><a href="/tags/FP" class="btn btn-info btn-xs">FP</a><a href="/tags/多值返回" class="btn btn-info btn-xs">多值返回</a><a href="/tags/lambda" class="btn btn-info btn-xs">lambda</a><a href="/tags/AssetManager" class="btn btn-info btn-xs">AssetManager</a><a href="/tags/libgdx" class="btn btn-info btn-xs">libgdx</a><a href="/tags/pprof" class="btn btn-info btn-xs">pprof</a><a href="/tags/微博数据分析" class="btn btn-info btn-xs">微博数据分析</a><a href="/tags/cdn" class="btn btn-info btn-xs">cdn</a><a href="/tags/云风" class="btn btn-info btn-xs">云风</a><a href="/tags/hive" class="btn btn-info btn-xs">hive</a><a href="/tags/调度器" class="btn btn-info btn-xs">调度器</a><a href="/tags/flash" class="btn btn-info btn-xs">flash</a><a href="/tags/planeshift" class="btn btn-info btn-xs">planeshift</a><a href="/tags/分段栈" class="btn btn-info btn-xs">分段栈</a><a href="/tags/terminal" class="btn btn-info btn-xs">terminal</a><a href="/tags/godit" class="btn btn-info btn-xs">godit</a><a href="/tags/转载" class="btn btn-info btn-xs">转载</a><a href="/tags/OpenGL" class="btn btn-info btn-xs">OpenGL</a><a href="/tags/年终总结" class="btn btn-info btn-xs">年终总结</a><a href="/tags/翻译" class="btn btn-info btn-xs">翻译</a><a href="/tags/facebook" class="btn btn-info btn-xs">facebook</a><a href="/tags/编程感悟" class="btn btn-info btn-xs">编程感悟</a><a href="/tags/架构" class="btn btn-info btn-xs">架构</a><a href="/tags/C" class="btn btn-info btn-xs">C</a><a href="/tags/CSP" class="btn btn-info btn-xs">CSP</a><a href="/tags/acme" class="btn btn-info btn-xs">acme</a><a href="/tags/编辑器" class="btn btn-info btn-xs">编辑器</a><a href="/tags/devdraw" class="btn btn-info btn-xs">devdraw</a><a href="/tags/mmorpg" class="btn btn-info btn-xs">mmorpg</a><a href="/tags/ouster" class="btn btn-info btn-xs">ouster</a><a href="/tags/一致性" class="btn btn-info btn-xs">一致性</a><a href="/tags/翻墙" class="btn btn-info btn-xs">翻墙</a><a href="/tags/n6bagent" class="btn btn-info btn-xs">n6bagent</a><a href="/tags/性能优化" class="btn btn-info btn-xs">性能优化</a><a href="/tags/继承" class="btn btn-info btn-xs">继承</a><a href="/tags/接口" class="btn btn-info btn-xs">接口</a><a href="/tags/DSP" class="btn btn-info btn-xs">DSP</a><a href="/tags/aerospike" class="btn btn-info btn-xs">aerospike</a><a href="/tags/kv" class="btn btn-info btn-xs">kv</a><a href="/tags/ssd" class="btn btn-info btn-xs">ssd</a><a href="/tags/raft" class="btn btn-info btn-xs">raft</a><a href="/tags/overcommit" class="btn btn-info btn-xs">overcommit</a><a href="/tags/nosql" class="btn btn-info btn-xs">nosql</a><a href="/tags/coroutine" class="btn btn-info btn-xs">coroutine</a><a href="/tags/plan9" class="btn btn-info btn-xs">plan9</a><a href="/tags/grt" class="btn btn-info btn-xs">grt</a><a href="/tags/database" class="btn btn-info btn-xs">database</a><a href="/tags/垃圾回收" class="btn btn-info btn-xs">垃圾回收</a><a href="/tags/lambda演算" class="btn btn-info btn-xs">lambda演算</a><a href="/tags/网络编程" class="btn btn-info btn-xs">网络编程</a><a href="/tags/epoll" class="btn btn-info btn-xs">epoll</a><a href="/tags/select" class="btn btn-info btn-xs">select</a><a href="/tags/io模型" class="btn btn-info btn-xs">io模型</a><a href="/tags/阻塞" class="btn btn-info btn-xs">阻塞</a><a href="/tags/同步" class="btn btn-info btn-xs">同步</a><a href="/tags/dynomite" class="btn btn-info btn-xs">dynomite</a><a href="/tags/session" class="btn btn-info btn-xs">session</a><a href="/tags/beego" class="btn btn-info btn-xs">beego</a><a href="/tags/codis" class="btn btn-info btn-xs">codis</a><a href="/tags/ycombinator" class="btn btn-info btn-xs">ycombinator</a><a href="/tags/热重启" class="btn btn-info btn-xs">热重启</a><a href="/tags/跳表" class="btn btn-info btn-xs">跳表</a><a href="/tags/skiplist" class="btn btn-info btn-xs">skiplist</a><a href="/tags/监控" class="btn btn-info btn-xs">监控</a><a href="/tags/zipkin" class="btn btn-info btn-xs">zipkin</a><a href="/tags/influxdb" class="btn btn-info btn-xs">influxdb</a><a href="/tags/heka" class="btn btn-info btn-xs">heka</a><a href="/tags/分布式跟踪" class="btn btn-info btn-xs">分布式跟踪</a><a href="/tags/bug" class="btn btn-info btn-xs">bug</a><a href="/tags/gorilla" class="btn btn-info btn-xs">gorilla</a><a href="/tags/middleware" class="btn btn-info btn-xs">middleware</a><a href="/tags/http" class="btn btn-info btn-xs">http</a><a href="/tags/object" class="btn btn-info btn-xs">object</a><a href="/tags/closure" class="btn btn-info btn-xs">closure</a><a href="/tags/nanopass" class="btn btn-info btn-xs">nanopass</a><a href="/tags/位运算" class="btn btn-info btn-xs">位运算</a><a href="/tags/swapcontext" class="btn btn-info btn-xs">swapcontext</a><a href="/tags/汇编" class="btn btn-info btn-xs">汇编</a><a href="/tags/trampoline" class="btn btn-info btn-xs">trampoline</a><a href="/tags/cps" class="btn btn-info btn-xs">cps</a><a href="/tags/continuation" class="btn btn-info btn-xs">continuation</a><a href="/tags/callback" class="btn btn-info btn-xs">callback</a><a href="/tags/closure-convert" class="btn btn-info btn-xs">closure-convert</a><a href="/tags/redis" class="btn btn-info btn-xs">redis</a><a href="/tags/逻辑时钟" class="btn btn-info btn-xs">逻辑时钟</a><a href="/tags/logical clock" class="btn btn-info btn-xs">logical clock</a><a href="/tags/服务发现" class="btn btn-info btn-xs">服务发现</a><a href="/tags/配置中心" class="btn btn-info btn-xs">配置中心</a><a href="/tags/chicken" class="btn btn-info btn-xs">chicken</a><a href="/tags/调试" class="btn btn-info btn-xs">调试</a><a href="/tags/VM" class="btn btn-info btn-xs">VM</a><a href="/tags/srfi-18" class="btn btn-info btn-xs">srfi-18</a><a href="/tags/call/cc" class="btn btn-info btn-xs">call/cc</a><a href="/tags/p2p" class="btn btn-info btn-xs">p2p</a><a href="/tags/delivery" class="btn btn-info btn-xs">delivery</a><a href="/tags/动态规划" class="btn btn-info btn-xs">动态规划</a><a href="/tags/网络" class="btn btn-info btn-xs">网络</a><a href="/tags/lua" class="btn btn-info btn-xs">lua</a><a href="/tags/sql" class="btn btn-info btn-xs">sql</a><a href="/tags/cockroachdb" class="btn btn-info btn-xs">cockroachdb</a><a href="/tags/isolation" class="btn btn-info btn-xs">isolation</a><a href="/tags/snapshot" class="btn btn-info btn-xs">snapshot</a><a href="/tags/serializable" class="btn btn-info btn-xs">serializable</a><a href="/tags/链表" class="btn btn-info btn-xs">链表</a><a href="/tags/ltask" class="btn btn-info btn-xs">ltask</a><a href="/tags/channel" class="btn btn-info btn-xs">channel</a><a href="/tags/leetcode" class="btn btn-info btn-xs">leetcode</a><a href="/tags/Rust" class="btn btn-info btn-xs">Rust</a><a href="/tags/socket" class="btn btn-info btn-xs">socket</a><a href="/tags/interpret" class="btn btn-info btn-xs">interpret</a><a href="/tags/可串行化" class="btn btn-info btn-xs">可串行化</a><a href="/tags/spanner" class="btn btn-info btn-xs">spanner</a><a href="/tags/分布式" class="btn btn-info btn-xs">分布式</a><a href="/tags/transaction" class="btn btn-info btn-xs">transaction</a><a href="/tags/SQL" class="btn btn-info btn-xs">SQL</a><a href="/tags/parser" class="btn btn-info btn-xs">parser</a><a href="/tags/内存池" class="btn btn-info btn-xs">内存池</a><a href="/tags/allocator" class="btn btn-info btn-xs">allocator</a><a href="/tags/combinator" class="btn btn-info btn-xs">combinator</a><a href="/tags/monad" class="btn btn-info btn-xs">monad</a><a href="/tags/ocaml" class="btn btn-info btn-xs">ocaml</a><a href="/tags/abstract machine" class="btn btn-info btn-xs">abstract machine</a><a href="/tags/ZINC" class="btn btn-info btn-xs">ZINC</a><a href="/tags/currying" class="btn btn-info btn-xs">currying</a><a href="/tags/type infer" class="btn btn-info btn-xs">type infer</a><a href="/tags/HM" class="btn btn-info btn-xs">HM</a><a href="/tags/类型系统" class="btn btn-info btn-xs">类型系统</a><a href="/tags/leak" class="btn btn-info btn-xs">leak</a><a href="/tags/reset" class="btn btn-info btn-xs">reset</a><a href="/tags/shift" class="btn btn-info btn-xs">shift</a><a href="/tags/delimited" class="btn btn-info btn-xs">delimited</a><a href="/tags/dectect" class="btn btn-info btn-xs">dectect</a><a href="/tags/race" class="btn btn-info btn-xs">race</a><a href="/tags/schema" class="btn btn-info btn-xs">schema</a><a href="/tags/hybrid logical clock" class="btn btn-info btn-xs">hybrid logical clock</a><a href="/tags/memory" class="btn btn-info btn-xs">memory</a><a href="/tags/TiDB" class="btn btn-info btn-xs">TiDB</a><a href="/tags/pattern match" class="btn btn-info btn-xs">pattern match</a><a href="/tags/shen" class="btn btn-info btn-xs">shen</a><a href="/tags/context" class="btn btn-info btn-xs">context</a><a href="/tags/缤果盒子" class="btn btn-info btn-xs">缤果盒子</a><a href="/tags/variant" class="btn btn-info btn-xs">variant</a><a href="/tags/pool" class="btn btn-info btn-xs">pool</a><a href="/tags/goroutine" class="btn btn-info btn-xs">goroutine</a><a href="/tags/morestack" class="btn btn-info btn-xs">morestack</a><a href="/tags/RC" class="btn btn-info btn-xs">RC</a><a href="/tags/SI" class="btn btn-info btn-xs">SI</a><a href="/tags/opentracing" class="btn btn-info btn-xs">opentracing</a><a href="/tags/klambda" class="btn btn-info btn-xs">klambda</a><a href="/tags/优化" class="btn btn-info btn-xs">优化</a><a href="/tags/Cello" class="btn btn-info btn-xs">Cello</a><a href="/tags/fat pointer" class="btn btn-info btn-xs">fat pointer</a><a href="/tags/eval" class="btn btn-info btn-xs">eval</a><a href="/tags/ddl" class="btn btn-info btn-xs">ddl</a><a href="/tags/codegen" class="btn btn-info btn-xs">codegen</a><a href="/tags/expression" class="btn btn-info btn-xs">expression</a><a href="/tags/erlang" class="btn btn-info btn-xs">erlang</a><a href="/tags/withcancel" class="btn btn-info btn-xs">withcancel</a><a href="/tags/constant propagate" class="btn btn-info btn-xs">constant propagate</a><a href="/tags/KISS" class="btn btn-info btn-xs">KISS</a><a href="/tags/性能" class="btn btn-info btn-xs">性能</a><a href="/tags/macro" class="btn btn-info btn-xs">macro</a><a href="/tags/hygiene" class="btn btn-info btn-xs">hygiene</a><a href="/tags/er-macro-transform" class="btn btn-info btn-xs">er-macro-transform</a><a href="/tags/cora" class="btn btn-info btn-xs">cora</a><a href="/tags/module" class="btn btn-info btn-xs">module</a><a href="/tags/错误处理" class="btn btn-info btn-xs">错误处理</a><a href="/tags/contract" class="btn btn-info btn-xs">contract</a><a href="/tags/union store" class="btn btn-info btn-xs">union store</a><a href="/tags/calvin" class="btn btn-info btn-xs">calvin</a><a href="/tags/bytecode" class="btn btn-info btn-xs">bytecode</a><a href="/tags/JVM" class="btn btn-info btn-xs">JVM</a><a href="/tags/aurora" class="btn btn-info btn-xs">aurora</a><a href="/tags/tidb" class="btn btn-info btn-xs">tidb</a><a href="/tags/vm" class="btn btn-info btn-xs">vm</a><a href="/tags/executor" class="btn btn-info btn-xs">executor</a><a href="/tags/covariance" class="btn btn-info btn-xs">covariance</a><a href="/tags/GC" class="btn btn-info btn-xs">GC</a><a href="/tags/oberon" class="btn btn-info btn-xs">oberon</a><a href="/tags/sysbench" class="btn btn-info btn-xs">sysbench</a><a href="/tags/effect" class="btn btn-info btn-xs">effect</a><a href="/tags/await" class="btn btn-info btn-xs">await</a><a href="/tags/async" class="btn btn-info btn-xs">async</a><a href="/tags/promise" class="btn btn-info btn-xs">promise</a><a href="/tags/interface" class="btn btn-info btn-xs">interface</a><a href="/tags/privilege" class="btn btn-info btn-xs">privilege</a><a href="/tags/test" class="btn btn-info btn-xs">test</a><a href="/tags/inferno" class="btn btn-info btn-xs">inferno</a><a href="/tags/microKanren" class="btn btn-info btn-xs">microKanren</a><a href="/tags/miniKanren" class="btn btn-info btn-xs">miniKanren</a><a href="/tags/zenlife" class="btn btn-info btn-xs">zenlife</a><a href="/tags/domain" class="btn btn-info btn-xs">domain</a><a href="/tags/HLC" class="btn btn-info btn-xs">HLC</a><a href="/tags/distributed" class="btn btn-info btn-xs">distributed</a><a href="/tags/deadlock" class="btn btn-info btn-xs">deadlock</a><a href="/tags/encrypt" class="btn btn-info btn-xs">encrypt</a><a href="/tags/authentication" class="btn btn-info btn-xs">authentication</a><a href="/tags/binlog" class="btn btn-info btn-xs">binlog</a><a href="/tags/probability" class="btn btn-info btn-xs">probability</a><a href="/tags/hotspot" class="btn btn-info btn-xs">hotspot</a><a href="/tags/makefile" class="btn btn-info btn-xs">makefile</a><a href="/tags/cache" class="btn btn-info btn-xs">cache</a><a href="/tags/ffi" class="btn btn-info btn-xs">ffi</a><a href="/tags/itx" class="btn btn-info btn-xs">itx</a><a href="/tags/prepare" class="btn btn-info btn-xs">prepare</a><a href="/tags/code review" class="btn btn-info btn-xs">code review</a><a href="/tags/darkeden" class="btn btn-info btn-xs">darkeden</a><a href="/tags/dependent" class="btn btn-info btn-xs">dependent</a><a href="/tags/type" class="btn btn-info btn-xs">type</a><a href="/tags/koka" class="btn btn-info btn-xs">koka</a><a href="/tags/引用计数" class="btn btn-info btn-xs">引用计数</a><a href="/tags/algebraic effect" class="btn btn-info btn-xs">algebraic effect</a><a href="/tags/RWMutex" class="btn btn-info btn-xs">RWMutex</a><a href="/tags/软件工程" class="btn btn-info btn-xs">软件工程</a><a href="/tags/开发环境" class="btn btn-info btn-xs">开发环境</a><a href="/tags/code generation" class="btn btn-info btn-xs">code generation</a><a href="/tags/CI" class="btn btn-info btn-xs">CI</a><a href="/tags/regex" class="btn btn-info btn-xs">regex</a><a href="/tags/PEG" class="btn btn-info btn-xs">PEG</a><a href="/tags/architecture" class="btn btn-info btn-xs">architecture</a><a href="/tags/cloud native" class="btn btn-info btn-xs">cloud native</a><a href="/tags/gambit" class="btn btn-info btn-xs">gambit</a><a href="/tags/ebpf" class="btn btn-info btn-xs">ebpf</a><a href="/tags/bpftrace" class="btn btn-info btn-xs">bpftrace</a><a href="/tags/流控" class="btn btn-info btn-xs">流控</a><a href="/tags/oom" class="btn btn-info btn-xs">oom</a><a href="/tags/severless" class="btn btn-info btn-xs">severless</a><a href="/tags/coprocessor" class="btn btn-info btn-xs">coprocessor</a><a href="/tags/treadmill" class="btn btn-info btn-xs">treadmill</a><a href="/tags/MVCC" class="btn btn-info btn-xs">MVCC</a><a href="/tags/hole digging" class="btn btn-info btn-xs">hole digging</a><a href="/tags/NAT" class="btn btn-info btn-xs">NAT</a><a href="/tags/reverse proxying" class="btn btn-info btn-xs">reverse proxying</a><a href="/tags/tunnel" class="btn btn-info btn-xs">tunnel</a><a href="/tags/累积分布函数" class="btn btn-info btn-xs">累积分布函数</a><a href="/tags/eCDF" class="btn btn-info btn-xs">eCDF</a><a href="/tags/SEDA" class="btn btn-info btn-xs">SEDA</a><a href="/tags/top-of-stack-caching" class="btn btn-info btn-xs">top-of-stack-caching</a><a href="/tags/exception" class="btn btn-info btn-xs">exception</a><a href="/tags/resumable" class="btn btn-info btn-xs">resumable</a><a href="/tags/string" class="btn btn-info btn-xs">string</a><a href="/tags/ActivityPub" class="btn btn-info btn-xs">ActivityPub</a><a href="/tags/mastodon" class="btn btn-info btn-xs">mastodon</a><a href="/tags/schedule" class="btn btn-info btn-xs">schedule</a><a href="/tags/concurrent" class="btn btn-info btn-xs">concurrent</a><a href="/tags/lru" class="btn btn-info btn-xs">lru</a><a href="/tags/scale" class="btn btn-info btn-xs">scale</a><a href="/tags/recursive" class="btn btn-info btn-xs">recursive</a><a href="/tags/patch" class="btn btn-info btn-xs">patch</a><a href="/tags/go" class="btn btn-info btn-xs">go</a><a href="/tags/bazel" class="btn btn-info btn-xs">bazel</a><a href="/tags/union scan" class="btn btn-info btn-xs">union scan</a><a href="/tags/technical debt" class="btn btn-info btn-xs">technical debt</a><a href="/tags/library" class="btn btn-info btn-xs">library</a><a href="/tags/framework" class="btn btn-info btn-xs">framework</a><a href="/tags/queueing delay" class="btn btn-info btn-xs">queueing delay</a><a href="/tags/queueing theory" class="btn btn-info btn-xs">queueing theory</a><a href="/tags/queueing" class="btn btn-info btn-xs">queueing</a><a href="/tags/threaded-code" class="btn btn-info btn-xs">threaded-code</a><a href="/tags/jit" class="btn btn-info btn-xs">jit</a><a href="/tags/copy-and-patch" class="btn btn-info btn-xs">copy-and-patch</a><a href="/tags/fips" class="btn btn-info btn-xs">fips</a><a href="/tags/delimited-continuation" class="btn btn-info btn-xs">delimited-continuation</a><a href="/tags/tailfication" class="btn btn-info btn-xs">tailfication</a><a href="/tags/clean code" class="btn btn-info btn-xs">clean code</a><a href="/tags/design" class="btn btn-info btn-xs">design</a><a href="/tags/AI" class="btn btn-info btn-xs">AI</a><a href="/tags/软件事务内存" class="btn btn-info btn-xs">软件事务内存</a><a href="/tags/STM" class="btn btn-info btn-xs">STM</a><a href="/tags/debugger" class="btn btn-info btn-xs">debugger</a><a href="/tags/namebase" class="btn btn-info btn-xs">namebase</a><a href="/tags/r7rs" class="btn btn-info btn-xs">r7rs</a><a href="/tags/namespace" class="btn btn-info btn-xs">namespace</a><a href="/tags/package" class="btn btn-info btn-xs">package</a><a href="/tags/mark-sweep" class="btn btn-info btn-xs">mark-sweep</a><a href="/tags/mostly-copying" class="btn btn-info btn-xs">mostly-copying</a><a href="/tags/tailcall" class="btn btn-info btn-xs">tailcall</a><a href="/tags/cml" class="btn btn-info btn-xs">cml</a><a href="/tags/type checker" class="btn btn-info btn-xs">type checker</a><a href="/tags/gc" class="btn btn-info btn-xs">gc</a><a href="/tags/am40" class="btn btn-info btn-xs">am40</a><a href="/tags/旁路由" class="btn btn-info btn-xs">旁路由</a><a href="/tags/nas" class="btn btn-info btn-xs">nas</a><a href="/tags/tracing" class="btn btn-info btn-xs">tracing</a><a href="/tags/multicore" class="btn btn-info btn-xs">multicore</a><a href="/tags/concurrency" class="btn btn-info btn-xs">concurrency</a><a href="/tags/rust" class="btn btn-info btn-xs">rust</a><a href="/tags/cranelift" class="btn btn-info btn-xs">cranelift</a><a href="/tags/c" class="btn btn-info btn-xs">c</a></div></div></div></div><hr /><footer><p class="nav navbar-nav navbar-right">Powered by <a href="https://clojure.org/">Clojure</a> &amp; <a href="//getbootstrap.com/">Bootstrap</a></p></footer></body></html>